    .model huge 
    .stack 64
    .data

    ; 0 -> instruction 1 -> power1 2 -> power2 3 -> power3 5 -> power5 6 -> power6 7 -> chat  8 -> p1 win 9-> p2 win 

    det_p6 db 0 
    sent_instruct_type db 0  
    instucti0n_type db 0   
    p1_button_F1_F2_ESC db 8
    p2_button_F1_F2_ESC db 7
    chat_invitation db    'you sent Chat invitation to ','$'
    game_invitation db    'you sent Game invitation to ','$'
    end_mes db 'end game $'
    chat_invitation2 db    ' sent Chat invitation to you ','$'
    game_invitation2 db    ' sent Game invitation to you','$' 

    V_S_R db 0
    not_r db 0
    check_buffer_status db 0
    instructions db "MOV ", "ADD ", "SUB ", "MUL ", "DIV ", "INC ", "DEC ", "NOP ", "SAL ", "SHR ", "SHL ", "ROR ", "ROL ", "SAR ","IDIV ", "IMUL "  
        registers db "AX ", "AL ", "AH ", "BX ", "BL ", "BH ", "CX ", "CL ", "CH ", "DX ", "DL ", "DH ", "SI ", "DI ", "SP ", "BP ","val ","address "
        digits db "0 ", "1 ", "2 ", "3 ", "4 ", "5 ", "6 ", "7 ", "8 ", "9 " ,"A ","B ","C ","D ","E ","F "  
        PLAYERTURN DB 0
            instruction_index db 0
            src_index_reg db 0
            dest_index_reg db 17
            src_index_val db 0
            dest_index_val db 18 
            address_mode db 0 
            address_mode2 db 0  
            count_bit_1 db 1   
            count_bit_2 db 1
            losepoint db 0
            initial_point db ?
            enter_name db "Please, Enter your name: $"
            initialP db "Initial Points: $"
            press db "Press Enter key to continue$"
            forbiddenCharMess db "Enter forbidden char for your opponent: $"
            LEVEL2MESS db "Enter Initial Values for Your Registers$"
            winmess db 'THE WINNER IS: $'
            DESTORSRC DB 0    ;      0----->DEST  , 1------>SRC
        power3_player1_used db 0
        power3_player2_used db 0
        INITIALVALUE DW ? 
        TEMP DB ?  

        power5_player1_used db 0
        power5_player2_used db 0
            ; player1 Data variables -----------------------------------------------------------------------------------
                Forbidden_digits_1 db '0000000000000000'
                Forbidden_Registers_1 db '0000000000000000'
                Forbidden_instruction_1 db '0000000000000000' 
                player1_mess db "Player 1 data$"
                levelMessage db "Enter the level (1 or 2): $"
                player1_name db 15 , ?, 15 dup("$"),'$'
                Forbidden_char1 db 'M'
                intial_points_player1 db 4, ?, 4 dup(0)
                losepoint_player1 db 0
                selected_level db ?
                data_segment_1 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 
                Player1_Data_Register db 00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,05h
                power_up_player1 db 0
            ;------------------------    AH  -Al -BH-Bl -CH  -CL-DH  -DL-  SI -     DI --   SP    - BP   -value-addressvalue----

            ; player2 Data variables --------------------------------------------------------------
                player2_mess db "Player 2 data$"
                Forbidden_digits_2 db '0000000000000000'
                Forbidden_Registers_2 db '0000000000000000'
                Forbidden_instruction_2 db '0000000000000000'
                Forbidden_char2 db 'M' 
                player2_name db 15 , ?, 15 dup("$"),'$'
                intial_points_player2 db 4, ?, 4 dup(0)
                losepoint_player2 db 0
                data_segment_2 db 0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0
                Player2_Data_Register db 00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,00h,05h,05h,00h,05h
                power_up_player2 db 0
            ;------------------------AH  -Al -BH-Bl -CH  -CL-DH  -DL-  SI -     DI --   SP    - BP   -value-addressvalue---- 
            
            x1 dw ?
            x2 dw ?
            y1 dw ?
            y2 dw ?
            VALUE DB 'VALUE','$'
            REGISTER DB 'REGISTER','$'
            ADDRESS DB 'ADDRESS','$'
            P1Name db 'Asaad', '$'
            P2Name db 'Nabil', '$'
            chara db 'c'
            ; regs names
                mess db 'AX: ','$'
                mess1 db 'BX: ','$'
                mess2 db 'CX: ','$'
                mess3 db 'DX: ','$'
                mess4 db 'SI:','$'
                mess5 db 'DI:','$'
                mess6 db 'SP:','$'
                mess7 db 'BP:','$'
                name1 db 'NAME:','$'
                POWER_BUTTON db 'POWER UPS','$'
                INSTRUCTION_BUTTON db 'INSTRUCTION','$'
                MOV_INS DB 'MOV','$'
                ADD_INS DB 'ADD','$'
                SUB_INS DB 'SUB','$'
                DIV_INS DB 'DIV','$'
                IDIV_INS DB 'IDIV','$'
                IMUL_INS DB 'IMUL', '$'
                XOR_INS DB 'MUL','$'
                AND_INS DB 'SAL','$'
                OR_INS DB 'SAR','$'
                NOP_INS DB 'NOP','$'
                SHR_INS DB 'SHR','$'
                SHL_INS DB 'SHL','$'
                ROR_INS DB 'ROR','$'
                ROL_INS DB 'ROL','$'
                INC_INS DB 'INC','$'
                DEC_INS DB 'DEC','$'
                ADDRESS_CHOICE DB 'MEM','$'
                REGISTER_CHOICE DB 'REG','$'
                VALUE_CHOICE DB 'VAL','$'
                AH_REG DB 'AH','$'
                AL_REG DB 'AL','$'
                AX_REG DB 'AX','$'
                BH_REG DB 'BH','$'
                BL_REG DB 'BL','$'
                BX_REG DB 'BX','$'
                CL_REG DB 'CL','$'
                CH_REG DB 'CH','$'
                CX_REG DB 'CX','$'
                DH_REG DB 'DH','$'
                DL_REG DB 'DL','$'
                DX_REG DB 'DX','$'
                SI_REG DB 'SI','$'
                DI_REG DB 'DI','$'
                SP_REG DB 'SP','$'
                BP_REG DB 'BP','$'
                POWER_UP_1ST DB 'P1','$'
                POWER_UP_2ST DB 'P2','$'
                POWER_UP_3ST DB 'P3','$'
                POWER_UP_5ST DB 'P5','$'
                PLAYER_ONE_NAME DB 15,?,15 DUP('$')
                PLAYER_TWO_NAME DB 15,?,15 DUP('$')
                PLAYER_ONE_TITLE DB 'PLAYER ONE:','$'
                PLAYER_TWO_TITLE DB 'PLAYER TWO:','$'
            INSTorPOWERUP DB ?
            
        Data_Segment_X db 27
        Data_Segment_Y db 1
        Counter db '0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'
        Counter_Segment db 16
        Register_Values_X db 60
        Register_Values_Y db 2
        Outer_Counter_RV db 8
        Inner_Counter_RV db 2
        Temp_Data db 0
        P1 db 'P1'
        P2 db 'P2'
            ;;tests
            x DW ?
            y dw ?
        enterMemAdress db 'Enter an address','$' 
        enterValue db 'Enter a value', '$' 
        enterNewGoal db "Enter new Goal$"
        ERROR_MESSAGE DB'ERROR','$'
        X_POWER_UP_3_TEMP db 'L'
        VALUE_COORDINATES DW 130,90,170,190
        REG_COORDINATES DW 210,90,250,190
        inputValueString db 5, ?, 5 dup('$')   
        inputValueSize db ?
        NUMBER DW ?
        player_turn db 1   ; player1-> 1 , player2-> 2 
        player_turn1 db 1   ; power up 2
        player_turn2 db 1   ; power up 2 
        win_player1 db 0
        win_player2 db 0   
        Initial_PL1 db 'I1:','$'
        Initial_PL2 db 'I2:','$'
        For1 db 'F1:','$'
        For2 db 'F2:','$'
        GOAL_VAR db 'GOAL:',"$"
        target dw 105eh
        NEWFORBIDDEN_MSG DB 'PLEASE ENTER NEW FORBIDDEN CHAR','$'
        P6_VAR DB 'P6'
        is_changed_p1 db 0 
        is_changed_p2 db 0
        is_changed db 0

        changed_target dw 1111h 
        ;;;;;;;;;;;;;;;;;;;;;;;;;;; instructions coordinates;;;;;;;;;;;;;;;;;;;;;;;;;;;
            MOVCORDINATES  dw 25,30,50,70
            ADDCORDINATES  dw 25,90,50,130
            SUBCORDINATES  dw 75,30,100,70 
            DIVCORDINATES  dw 75,90,100,130
            XORCORDINATES  dw 125,30,150,70
            ANDCORDINATES dw 125,90,150,130
            SHRCORDINATES dw 175,30,200,70
            NOPCORDINATES dw 175,90,200,130
            SHLCORDINATES  dw 220,30,250,70
            RORCORDINATES  dw 220,90,250,130
            ROLCORDINATES  dw 270,30,295,70
            INCCORDINATES  dw 270,90,295,130
            DECCORDINATES  dw 315,30,345,70
            ORCORDINATES  dw 315,90,345,130
            IMULCORDINATES dw 360,30,385,80
            IDIVCORDINATES dw 360,90,385,140
            P1CORDINATES dw 315,480,345,520
            P2CORDINATES DW 315,540,345,580
            P3CORDINATES DW 360,480,385,520
            P5CORDINATES DW 360,540,385,580
            P6CORDINATES DW 360,594,385,630

            ;DrawRec 360,594,385,630

        ;start game messages
            message1 db 'to start game prress f1$'
            message2 db 'to start chat prress f2$'
            message3 db 'to end game prress esc$'        ;;;;
            ;;;;
        
        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
        ; Chatting variables 
        CHAR db ?
        currSendRow db 0
        currSendCol db 0
        currRecRow db 13
        currRecCol db 0
        scanCode db ?

        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

                    rightShield db 23,5,40
            db 23,6,40,24,6,40
            db 23,7,40,25,7,40
            db 23,8,40,24,8,40,25,8,40
            db 24,9,40,25,9,40,26,9,40
            db 24,10,40,25,10,40,26,10,40,28,10,40
            db 23,11,40,24,11,40,27,11,40,28,11,40
            db 23,12,40,24,12,40,25,12,40,26,12,40,27,12,40,28,12,40,29,12,40
            db 22,13,40,23,13,40,24,13,40,26,13,40,27,13,40,28,13,40,29,13,40
            db 23,14,40,24,14,40,26,14,40,28,14,40,29,14,40
            db 23,15,40,24,15,40,25,15,40,27,15,40,28,15,40,29,15,40
            db 23,16,40,24,16,40,25,16,40,26,16,40,27,16,40,28,16,40
            db 24,17,40,25,17,40,26,17,40,27,17,40,28,17,40
            db 24,18,40,25,18,40,26,18,40,27,18,40,28,18,40
            db 24,19,40,25,19,40,26,19,40,27,19,40,28,19,40
            db 24,20,40,25,20,40,26,20,40,27,20,40,28,20,40
            db 24,21,40,25,21,40,26,21,40,27,21,40,28,21,40
            db 24,22,40,25,22,40,26,22,40,27,22,40,28,22,40
            db 24,23,40,25,23,40,26,23,40,27,23,40,28,23,40
            db 24,24,40,25,24,40,26,24,40,27,24,40,28,24,40
            db 24,25,40,25,25,40,26,25,40,27,25,40,28,25,40
            db 24,26,40,25,26,40,26,26,40,27,26,40,28,26,40
            db 24,27,40,25,27,40,26,27,40,27,27,40,28,27,40
            db 24,28,40,25,28,40,26,28,40,27,28,40,28,28,40
            db 24,29,40,25,29,40,26,29,40,27,29,40,28,29,40
            db 24,30,40,25,30,40,26,30,40,27,30,40,28,30,40
            db 24,31,40,25,31,40,26,31,40,27,31,40,28,31,40
            db 24,32,40,25,32,40,26,32,40,27,32,40,28,32,40
            db 24,33,40,25,33,40,26,33,40,27,33,40,28,33,40
            db 24,34,40,25,34,40,26,34,40,27,34,40,28,34,40
            db 24,35,40,25,35,40,26,35,40,27,35,40,28,35,40
            db 24,36,40,25,36,40,26,36,40,27,36,40,28,36,40
            db 24,37,40,25,37,40,26,37,40,27,37,40,28,37,40
            db 24,38,40,25,38,40,26,38,40,27,38,40,28,38,40
            db 24,39,40,25,39,40,26,39,40,27,39,40,28,39,40
            db 24,40,40,25,40,40,26,40,40,27,40,40,28,40,40
            db 24,41,40,25,41,40,26,41,40,27,41,40,28,41,40
            db 24,42,40,25,42,40,26,42,40,27,42,40,28,42,40
            db 24,43,40,25,43,40,26,43,40,27,43,40,28,43,40
            db 24,44,40,25,44,40,26,44,40,27,44,40,28,44,40
            db 23,45,40,24,45,40,25,45,40,26,45,40,27,45,40,28,45,40
            db 23,46,40,24,46,40,25,46,40,26,46,40,27,46,40,28,46,40
            db 23,47,40,24,47,40,25,47,40,26,47,40,28,47,40,29,47,40
            db 22,48,40,23,48,40,24,48,40,26,48,40,28,48,40,29,48,40
            db 22,49,40,23,49,40,24,49,40,26,49,40,27,49,40,28,49,40,29,49,40
            db 23,50,40,24,50,40,25,50,40,27,50,40,28,50,40,29,50,40
            db 23,51,40,24,51,40,26,51,40,27,51,40,28,51,40
            db 24,52,40,25,52,40,26,52,40
            db 24,53,40,25,53,40,26,53,40
            db 23,54,40,25,54,40,26,54,40
            db 23,55,40,24,55,40,25,55,40
            db 23,56,40
            db 23,57,4
            rightShieldSize dw 60 
            RightP_height dw 50
            RightP_Width dw 21
            Pr_x dw 200
            Pr_y dw 150     
            shooter db 24,2,27,25,2,27,23,3,27,24,3,44,25,3,44,26,3,28,23,4,43,24,4,44,25
            db 4,44,26,4,66,22,5,28,23,5,44,24,5,44,25,5,44,26,5,44,27,5,28,21
        db 6,0,22,6,66,23,6,44,24,6,44,25,6,44,26,6,44,27,6,66,15,7,0,16,7,0,21,7,0,22,7,43,23,7,44,24,7,44,25,7,44
        db 26,7,44,27,7,43,28,7,0,14,8,30,15,8,27,16,8,27,17,8,30,21,8,29,22,8,43,23,8,44,24,8,44,25,8,44
        db 26,8,44,27,8,43,28,8,29,32,8,30,33,8,27,34,8,27,12,9,0,13,9,0,14,9,27,15,9,44,16,9,44,17,9,27,18
        db 9,0,19,9,0,20,9,0,21,9,27,22,9,44,23,9,44
        db 24,9,44,25,9,44,26,9,44,27,9,44,28,9,28,29,9,0,30,9,0,31,9,0,32,9,27,33,9,44,34,9,44,35,9,27
        db 11,10,30,12,10,7,13,10,27,14,10,43,15,10,43,16,10,43,17,10,43,18,10,66,19,10,27,20,10,28,21,10,7
        db 22,10,7,23,10,44,24,10,43,25,10,43,26,10,44,27,10,7,28,10,7
        db 29,10,28,30,10,27,31,10,66,32,10,43,33,10,43,34,10,43,35,10,43,36,10,27,37,10,7,11
        db 11,28,12,11,44,13,11,44,14,11,44,15,11,44,16,11,44,17,11,44,18,11,44,19

        db 11,43,20,11,43,21,11,44,22,11,43,23,11,43,24,11,7,25,11,140,26,11,43,27,11
        db 43,28,11,44,29,11,43,30,11,43,31,11,44
        db 32,11,44,33,11,44,34,11,44,35,11,44,36,11,44,37,11,44,11,12,28,12,12,44,13
        db 12,44,14,12,44,15,12,44,16,12,44,17,12,44,18,12,44,19,12,43,20,12,43,21,12,44,22
        db 12,43,23,12,140,24,12,43,25,12,43,26,12,140,27,12,43,28,12,44,29,12,43,30,12,44
        db 31,12,44,32,12,44,33,12,44,34,12,44
        db 35,12,44,36,12,44,37,12,44,11,13,28,12,13,44,13,13,44,14,13,44,15,13,44,16
        db 13,44,17,13,44,18,13,44,19,13,44,20,13,43,21,13,43,22,13,140,23,13,43,24,13,43
        db 25,13,43,26,13,43,27,13,140,28,13,43,29,13,43,30,13,44,31,13,44,32,13,44,33
        db 13,44,34,13,44,35,13,44,36,13,44,37,13,44
        db 11,14,28,12,14,44,13,14,44,14,14,44,15,14,44,16,14,44,17,14,44,18,14,44,19
        db 14,44,20,14,43,21,14,43,22,14,43,23,14,43,24,14,44,25,14,44,26,14,43,27,14
        db 43,28,14,43,29,14,43,30,14,44,31,14,44,32,14,44,33,14,44,34,14,44,35,14,44,36
        db 14,44,37,14,44,11,15,28,12,15,44,13,15,44
        db 14,15,44,15,15,44,16,15,44,17,15,44,18,15,44,19,15,43,20,15,43,21,15,7,22
        db 15,43,23,15,43,24,15,44,25,15,44,26,15,43,27,15,43,28,15,7,29,15,7,30,15,44,31,15
        db 44,32,15,44,33,15,44,34,15,44,35,15,44,36,15,44,37,15,44,11,16
        db 29,12,16,44,13,16,44,14,16,44,15,16,44,16,16,44
        db 17,16,44,18,16,44,19,16,43,20,16,7,21,16,43,22,16,43,23,16,44,24,16,44,25

        db 16,44,26,16,44,27,16,43,28,16,43,29,16,7,30,16,43,31,16,44,32,16,44,33,16,44,34,16
        db 44,35,16,44,36,16,44,37,16,43,38,16,29,12,17,27,13,17,27,14,17,25,15,17,43,16
        db 17,43,17,17,25,18,17,27,19,17,28
        db 20,17,66,21,17,43,22,17,43,23,17,44,24,17,44,25,17,44,26,17,44,27,17,43,28
        db 17,43,29,17,66,30,17,28,31,17,27,32,17,25,33,17,43,34,17,43,35,17,25,36
        db 17,27,37,17,27,13,18,0,14,18,28,15,18,66,16,18,66,17,18,28,19,18,0,20,18,66
        db 21,18,43,22,18,43,23,18,44,24,18,44,25,18,44
        db 26,18,44,27,18,43,28,18,43,29,18,66,30,18,0,32,18,28,33,18,66,34,18,66,35
        db 18,28,36,18,0,15,19,0,16,19,0,19,19,0,20,19,43,21,19,43,22,19,43,23,19,44
        db 24,19,44,25,19,44,26,19,44,27,19,43,28,19,43,29,19,66,30,19,0,33,19,0,34
        db 19,0,19,20,0,20,20,43,21,20,43,22,20,43
        db 23,20,44,24,20,44,25,20,44,26,20,44,27,20,43,28,20,43,29,20,43,30,20,0
        db 19,21,30,20,21,43,21,21,43,22,21,43,23,21,44,24,21,44,25,21,44,26,21,44,27
        db 21,43,28,21,43,29,21,43,30,21,30,19,22,29,20,22,43,21,22,43,22,22,43,23,22
        db 44,24,22,44,25,22,44,26,22,44,27,22,43,28,22,43
        db 29,22,43,30,22,30,17,23,30,18,23,28,19,23,7,20,23,43,21,23,140,22,23
        db 140,23,23,43,24,23,43,25,23,43,26,23,43,27,23,140,28,23,140,29,23,43,30,23,7
        db 31,23,28,32,23,30,16,24,0,17,24,27,18,24,44,19,24,44,20,24,44,21,24,43,22
        db 24,44,23,24,44,24,24,44,25,24,44,26,24,44,27,24,44
        db 28,24,43,29,24,44,30,24,44,31,24,44,32,24,27,33,24,0,16,25,30,17,25
        db 43,18,25,44,19,25,44,20,25,44,21,25,43,22,25,44,23,25,44,24,25,43,25,25
        db 43,26,25,44,27,25,44,28,25,43,29,25,44,30,25,44,31,25,44,32,25,43,33,25
        db 30,16,26,28,17,26,44,18,26,44,19,26,44,20,26,44,21,26,43
        db 22,26,44,23,26,44,24,26,43,25,26,43,26,26,44,27,26,44,28,26,43,29,26
        db 44,30,26,44,31,26,44,32,26,44,33,26,28,16,27,27,17,27,44,18,27,44,19,27
        db 44,20,27,44,21,27,43,22,27,44,23,27,44,24,27,43,25,27,43,26,27,44,27,27
        db 43,28,27,43,29,27,44,30,27,44,31,27,44,32,27,44,33,27,27
        db 11,28,29,12,28,29,16,28,27,17,28,44,18,28,44,19,28,44,20,28,44,21,28
        db 44,22,28,43,23,28,44,24,28,43,25,28,43,26,28,44,27,28,43,28,28,44,29
        db 28,44,30,28,44,31,28,44,32,28,44,33,28,27,37,28,29,38,28,29,10,29,28,11
        db 29,43,12,29,43,13,29,29,16,29,27,17,29,44,18,29,44,19,29,44
        db 20,29,44,21,29,44,22,29,43,23,29,44,24,29,43,25,29,43,26,29,44,27,29
        db 43,28,29,44,29,29,44,30,29,44,31,29,44,32,29,44,33,29,27,36,29,28,37,29,43
        db 38,29,43,39,29,28,8,30,27,9,30,27,10,30,25,11,30,43,12,30,43,13,30,25
        db 14,30,27,15,30,28,16,30,28,17,30,44,18,30,44,19,30,44
        db 20,30,44,21,30,44,22,30,43,23,30,43,24,30,7,25,30,7,26,30,43,27,30,43
        db 28,30,44,29,30,44,30,30,44,31,30,44,32,30,44,33,30,29,34,30,28,35,30
        db 27,36,30,25,37,30,43,38,30,43,39,30,25,40,30,27,41,30,27,7,31,29,8,31
        db 43,9,31,44,10,31,44,11,31,43,12,31,43,13,31,44,14,31,44
        db 15,31,43,16,31,30,17,31,43,18,31,44,19,31,44,20,31,44,21,31,43,22,31
        db 43,23,31,43,24,31,43,25,31,27,26,31,43,27,31,43,28,31,43,29,31,44,30
        db 31,44,31,31,44,32,31,66,33,31,30,34,31,43,35,31,44,36,31,44,37,31,43,38,31,43,39,31,44,40,31,44,41,31,43,42,31,29,7,32,28,8,32,44
        db 9,32,44,10,32,44,11,32,43,12,32,43,13,32,44,14,32,44,15,32,43,16,32,29
        db 17,32,27,18,32,43,19,32,43,20,32,43,21,32,44,22,32,44,23,32,43,24,32,43
        db 25,32,43,26,32,43,27,32,44,28,32,44,29,32,43,30,32,43,31,32,43,32,32,28,33,32,29,34,32,43,35,32,44,36,32,44,37,32,43,38,32,43
        db 39,32,44,40,32,44,41,32,44,42,32,28,7,33,28,8,33,44,9,33,44,10,33,44,11
        db 33,43,12,33,43,13,33,44,14,33,44,15,33,44,16,33,25,17,33,66,18,33,44,19,33,44
        db 20,33,44,21,33,44,22,33,44,23,33,43,24,33,43,25,33,43,26,33,43,27,33,44,28,33,44,29,33,44,30,33,44,31,33,44,32,33,66
        db 33,33,25,34,33,44,35,33,44,36,33,44,37,33,43,38,33,43,39,33,44,40,33,44,41
        db 33,44,42,33,28,7,34,28,8,34,44,9,34,44,10,34,44,11,34,43,12,34,43,13,34,44,14
        db 34,43,15,34,43,16,34,44,17,34,44,18,34,44,19,34,44,20,34,44,21,34,44,22,34,44,23,34,43,24,34,43,25,34,43,26,34,43
        db 27,34,44,28,34,44,29,34,44,30,34,44,31,34,44,32,34,44,33,34,44,34,34,43,35
        db 34,43,36,34,44,37,34,43,38,34,43,39,34,44,40,34,44,41,34,44,42,34,28,7,35,28,8
        db 35,44,9,35,44,10,35,44,11,35,140,12,35,140,13,35,43,14,35,44,15,35,44,16,35,44,17,35,44,18,35,44,19,35,44,20,35,44
        db 21,35,44,22,35,44,23,35,43,24,35,43,25,35,43,26,35,43,27,35,44,28,35,44,29,35
        db 44,30,35,44,31,35,44,32,35,44,33,35,44,34,35,44,35,35,44,36,35,43,37,35,140,38,35
        db 140,39,35,44,40,35,44,41,35,44,42,35,28,8,36,43,9,36,44,10,36,140,11,36,43,12,36,164,13,36,44,14,36,44,15,36,44
        db 16,36,44,17,36,44,18,36,44,19,36,44,20,36,44,21,36,44,22,36,44,23,36,43,24,36,7
        db 25,36,25,26,36,43,27,36,44,28,36,44,29,36,44,30,36,44,31,36,44,32,36,44,33,36,44
        db 34,36,44,35,36,44,36,36,44,37,36,140,38,36,43,39,36,140,40,36,44,41,36,43,42,36,29
        db 8,37,25,9,37,43,10,37,43
        db 11,37,43,12,37,25,13,37,44,14,37,44,15,37,44,16,37,44,17,37,44,18,37,44,19,37,44
        db 20,37,44,21,37,44,22,37,44,23,37,44,24,37,43,25,37,43,26,37,44,27,37,44,28,37,44
        db 29,37,44,30,37,44,31,37,44,32,37,44,33,37,44,34,37,44,35,37,44,36,37,44,37,37,25,38,37,43,39,37,43,40,37,43
        db 41,37,25,6,38,27,7,38,43,8,38,44,9,38,44,10,38,43,11,38,43,12,38,25,13,38,44,14
        db 38,44,15,38,44,16,38,44,17,38,44,18,38,44,19,38,44,20,38,44,21,38,44,22,38,44,23
        db 38,44,24,38,44,25,38,44,26,38,44,27,38,44,28,38,44,29,38,44,30,38,44,31,38,44,32
        db 38,44,33,38,44,34,38,44
        db 35,38,44,36,38,44,37,38,25,38,38,7,39,38,43,40,38,44,41,38,44,42,38,43,43,38,27,5
        db 39,27,6,39,44,7,39,44,8,39,44,9,39,44,10,39,43,11,39,27,12,39,25,13,39,44,14,39,44
        db 15,39,44,16,39,44,17,39,44,18,39,44,19,39,44,20,39,44,21,39,43,22,39,66,23,39,27,24,39,27,25,39,27
        db 26,39,27,27,39,66,28,39,43,29,39,44,30,39,44,31,39,44,32,39,44,33,39,44,34,39,44
        db 35,39,44,36,39,44,37,39,25,38,39,7,39,39,43,40,39,44,41,39,44,42,39,44,43,39,44,44
        db 39,27,5,40,28,6,40,44,7,40,44,8,40,44,9,40,44,10,40,44,11,40,43,12,40,43,13,40,44,14,40,44,15,40,44
        db 16,40,43,17,40,43,18,40,66,19,40,27,20,40,28,21,40,30,22,40,0,29,40,28
        db 30,40,27,31,40,66,32,40,43,33,40,43,34,40,44,35,40,44,36,40,44,37,40,43,38
        db 40,43,39,40,44,40,40,44,41,40,44,42,40,44,43,40,44,44,40,28,5,41,30,6,41
        db 43,7,41,44,8,41,44,9,41,44,10,41,44,11,41,44
        db 12,41,43,13,41,43,14,41,66,15,41,27,16,41,29,17,41,0,18,41,0,33,41,29
        db 34,41,27,35,41,66,36,41,43,37,41,43,38,41,44,39,41,44,40,41,44,41,41,44,42
        db 41,44,43,41,43,6,42,43,7,42,44,8,42,44,9,42,43,10,42,66,11,42,27,12,42,29
        db 13,42,0,14,42,0,37,42,29,38,42,27,39,42,66
        db 40,42,43,41,42,44,42,42,44,43,42,43,5,43,0,6,43,27,7,43,27,8,43,28,9,43
        db 30,10,43,0,41,43,28,42,43,27,43,43,27,6,44,0
        shooterSize dw 48 
        
        bullet db 14,1,66,15,1,66,14,2,65,15,2,164,13,3,89,14,3,7,15,3,136,16,3,66,13,4,67,14,4,25,15,4
        db 208,16,4,24,13,5,66,14,5,25,15,5,17,16,5,24,13,6,66,14,6,164,15
        db 6,17,16,6,164,13,7,65,14,7,24,15,7,17,16,7,163,13,8,65,14,8,24,15,8,209,16,8,164,17,8,65,12,9,7
        db 13,9,66,14,9,164,15,9,210,16,9,164,17,9,25,12,10,24,13,10,66
        db 14,10,25,15,10,18,16,10,139,17,10,25,12,11,164,13,11,65,14,11
        db 25,15,11,209,16,11,140,17,11,24,12,12,27,13,12,67,14,12,164,15
        db 12,17,16,12,138,17,12,27,12,13,66,13,13,67,14,13,164,15,13,18,16,13,210,17,13,24,12,14,24
        db 13,14,66,14,14,25,15,14,211,16,14,137,17,14,164,12,15,24,13
        db 15,66,14,15,65,15,15,211,16,15,138,17,15,164,12,16,25,13,16,66
        db 14,16,65,15,16,210,16,16,137,17,16,24,12,17,164,13,17,66,14,17
        db 65,15,17,211,16,17,138,17,17,164,12,18,7,13,18,66,14,18,65,15,18,211,16,18,138,17,18,25,12,19,24
        db 13,19,66,14,19,65,15,19,236,16,19,138,17,19,164,12,20,25,13
        db 20,66,14,20,65,15,20,212,16,20,138,17,20,25,12,21,25,13,21,66
        db 14,21,65,15,21,236,16,21,138,17,21,24,12,22,164,13,22,66,14,22
        db 65,15,22,137,16,22,138,17,22,24,12,23,164,13,23,66,14,23,66,15,23,137,16,23,139,17,23,25,12,24,164
        db 13,24,66,14,24,65,15,24,212,16,24,139,17,24,27,12,25,27,13
        db 25,65,14,25,65,15,25,137,16,25,139,17,25,7,12,26,28,13,26,65
        db 14,26,6,15,26,114,16,26,164,17,26,28,13,27,30,14,27,27,15,27,7,16,27,28
        BulletSize dw 30 
        drawBulletOrNot db 0
        BULLET_X DW 200
        BULLET_Y DW 150
        chicken1 db 19,0,41,20,0,41,19,1,41,20,1,41,19,2,41,20,2,4,18,3,15,19,3,66,20,3,64
        db 21,3,91,18,4,27,19,4,30,20,4,15,21,4,28,22,4,160,18,5,7,19,5,22,20,5,23,21
        db 5,161,22,5,28,17,6,15,18,6,15,19,6,25,20,6,25,21,6,7,22,6,15,23,6,0,16,7,15,17,7,15,18,7,67
        db 19,7,43,20,7,43,21,7,65,22,7,30,23,7,30,16,8,0,17,8,90,18,8,42,19,8,6
        db 20,8,6,21,8,41,22,8,12,23,8,29,24,8,29,16,9,15,17,9,42,18,9,113,19,9,112
        db 20,9,184,21,9,113,22,9,6,23,9,28,24,9,29,16,10,0,17,10,29,18,10,6,19,10,41,20,10,6,21,10,6,22,10,7
        db 23,10,102,24,10,28,0,11,29,1,11,30,2,11,0,3,11,15,4,11,15,5,11,15,6,11
        db 15,7,11,15,16,11,28,17,11,81,18,11,7,19,11,6,20,11,41,21,11,24,22,11,80
        db 23,11,28,32,11,15,33,11,15,34,11,15,35,11,15,36,11,15,37,11,0,38,11,30
        db 39,11,29,0,12,28,1,12,29,2,12,30,3,12,30
        db 4,12,15,5,12,15,6,12,15,7,12,15,8,12,15,9,12,15,10,12,15,17,12,7,18
        db 12,80,19,12,12,20,12,41,21,12,7,22,12,28,29,12,15,30,12,15,31,12,15,32
        db 12,15,33,12,15,34,12,15,35,12,15,36,12,30,37,12,30,38,12,29,39,12,28,1
        db 13,28,2,13,28,3,13,28,4,13,29,5,13,29,6,13,30
        db 7,13,0,8,13,15,9,13,15,10,13,15,11,13,15,12,13,15,13,13,15,18,13,78
        db 19,13,12,20,13,41,21,13,25,22,13,25,26,13,15,27,13,15,28,13,15,29,13
        db 15,30,13,15,31,13,15,32,13,15,33,13,30,34,13,30,35,13,29,36,13,28,37
        db 13,28,38,13,28,2,14,28,3,14,27,4,14,27,5,14,27,6,14,28
        db 7,14,29,8,14,30,9,14,30,10,14,0,11,14,15,12,14,15,13,14,15,14,14,15
        db 15,14,15,17,14,53,18,14,53,19,14,6,20,14,41,21,14,3,22,14,3,24,14,15,25
        db 14,15,26,14,15,27,14,15,28,14,15,29,14,0,30,14,30,31,14,30,32,14,29,33
        db 14,28,34,14,28,35,14,27,36,14,27,37,14,28,4,15,27
        db 5,15,7,6,15,7,7,15,27,8,15,27,9,15,27,10,15,28,11,15,29,12,15,30,13
        db 15,0,14,15,15,15,15,15,16,15,15,17,15,77,18,15,53,19,15,25,20,15,23
        db 21,15,3,22,15,3,23,15,30,24,15,15,25,15,15,26,15,15,27,15,30,28,15
        db 29,29,15,28,30,15,27,31,15,27,32,15,27,33,15,7,34,15,7
        db 35,15,27,0,16,30,1,16,15,2,16,15,3,16,15,4,16,15,5,16,0,6,16,29,7
        db 16,29,8,16,28,9,16,28,10,16,27,11,16,27,12,16,27,13,16,27,14,16,29
        db 15,16,30,16,16,102,17,16,11,18,16,101,19,16,15,20,16,0,21,16,78,22
        db 16,3,23,16,78,24,16,30,25,16,29,26,16,28,27,16,27,28,16,27
        db 29,16,27,30,16,28,31,16,28,32,16,29,33,16,29,34,16,30,35,16,15,36,16,15,37
        db 16,15,38,16,15,39,16,30,0,17,29,1,17,29,2,17,30,3,17,30,4,17,30,5,17,0,6,17
        db 15,7,17,15,8,17,15,9,17,15,10,17,0,11,17,30,12,17,29,13,17,28,14,17,7,15,17,7,16,17,53,17,17,11,18,17,101
        db 19,17,77,20,17,102,21,17,0,22,17,78,23,17,3,24,17,25,25,17,27,26,17
        db 28,27,17,29,28,17,30,29,17,30,30,17,15,31,17,15,32,17,15,33,17,15,34,17
        db 15,35,17,30,36,17,30,37,17,30,38,17,29,39,17,29,0,18,29,1,18,28,2,18,28
        db 3,18,28,4,18,28,5,18,28,6,18,28,7,18,28,8,18,29
        db 9,18,29,10,18,29,11,18,30,12,18,30,13,18,30,14,18,29,15,18,11,16,18
        db 11,17,18,11,18,18,11,19,18,78,20,18,78,21,18,15,22,18,78,23,18,3,24,18
        db 3,25,18,28,26,18,0,27,18,30,28,18,30,29,18,29,30,18,29,31,18,29,32,18
        db 28,33,18,28,34,18,28,35,18,28,36,18,28,37,18,28,38,18,28
        db 39,18,29,2,19,28,3,19,27,4,19,7,5,19,7,6,19,27,7,19,28,8,19,28,9,19
        db 28,10,19,28,11,19,28,12,19,28,13,19,28,14,19,78,15,19,11,16,19,11,17
        db 19,11,18,19,77,19,19,77,20,19,30,21,19,101,22,19,78,23,19,3,24,19,3
        db 25,19,3,26,19,28,27,19,28,28,19,28,29,19,28,30,19,28
        db 31,19,28,32,19,28,33,19,27,34,19,7,35,19,7,36,19,27,37,19,28,3,20
        db 30,4,20,29,5,20,29,6,20,30,7,20,0,8,20,0,9,20,0,10,20,0,11,20,0,12
        db 20,30,13,20,102,14,20,53,15,20,11,16,20,11,17,20,11,18,20,102,19,20
        db 15,20,20,15,21,20,78,22,20,78,23,20,3,24,20,3,25,20,3
        db 26,20,7,27,20,30,28,20,0,29,20,0,30,20,0,31,20,0,32,20,0,33,20,30
        db 34,20,29,35,20,29,36,20,29,1,21,28,2,21,29,3,21,30,4,21,30,5,21,30,6
        db 21,30,7,21,29,8,21,29,9,21,28,10,21,27,11,21,7,12,21,7,13,21,11,14,21,11,15
        db 21,11,16,21,11,17,21,11,18,21,78,19,21,78
        db 20,21,102,21,21,30,22,21,78,23,21,3,24,21,3,25,21,3,26,21,3,27,21,25,28,21
        db 27,29,21,27,30,21,28,31,21,29,32,21,29,33,21,30,34,21,30,35,21,30,36,21,30,37
        db 21,29,38,21,28,1,22,29,2,22,29,3,22,28,4,22,28,5,22,28,6,22,27,7,22,7,8,22,25,9,22,7,10,22,27,11,22,28
        db 12,22,78,13,22,53,14,22,11,15,22,11,16,22,11,17,22,11,18,22,78,19,22,78,20,22
        db 103,21,22,15,22,22,3,23,22,3,24,22,3,25,22,3,26,22,3,27,22,172,28,22,28,29,22
        db 27,30,22,7,31,22,25,32,22,7,33,22,27,34,22,28,35,22,28,36,22,28,37,22,29,38,22,29,3,23,29,4,23,28,5,23,27
        db 6,23,7,7,23,7,8,23,28,9,23,30,10,23,0,11,23,30,12,23,77,13,23,53,14,23,11,15
        db 23,11,16,23,11,17,23,77,18,23,102,19,23,78,20,23,30,21,23,30,22,23,3,23,23,3,24
        db 23,3,25,23,3,26,23,3,27,23,3,28,23,29,29,23,15,30,23,30,31,23,28,32,23,27,33,23,7,34,23,27,35,23,28
        db 36,23,29,5,24,29,6,24,29,7,24,30,8,24,30,9,24,29,10,24,27,11,24,25,12,24,53
        db 13,24,11,14,24,11,15,24,11,16,24,78,17,24,102,18,24,0,19,24,15,20,24,30,21,24
        db 78,22,24,3,23,24,3,24,24,3,25,24,3,26,24,3,27,24,3,28,24,24,29,24,88,30,24,29,31,24,30,32,24,30,33,24,30
        db 34,24,29,4,25,28,5,25,29,6,25,29,7,25,28,8,25,28,9,25,27,10,25,25,11,25,79
        db 12,25,11,13,25,11,14,25,78,15,25,78,16,25,78,17,25,78,18,25,3,19,25,3,20,25
        db 3,21,25,3,22,25,3,23,25,3,24,25,3,25,25,3,26,25,3,27,25,3,28,25,3,29,25,25,30,25,27,31,25,28,32,25,28
        db 33,25,29,34,25,29,35,25,29,4,26,29,5,26,29,6,26,29,7,26,29,8,26,28,9,26,27
        db 10,26,79,11,26,53,12,26,78,13,26,78,14,26,78,15,26,78,16,26,78,17,26,78,18,26
        db 3,19,26,3,20,26,3,21,26,3,22,26,3,23,26,3,24,26,3,25,26,3,26,26,3,27,26,148,28,26,3,29,26,3,30,26,7
        db 31,26,28,32,26,29,33,26,29,34,26,29,35,26,29,10,27,53,11,27,78,12,27,53,13
        db 27,3,14,27,3,15,27,53,16,27,53,17,27,3,18,27,3,19,27,3,20,27,3,21,27,3,22,27
        db 3,23,27,3,24,27,3,25,27,148,26,27,148,27,27,148,28,27,3,29,27,3,11,28,3,12,28,3,13,28,53,14,28,3,15,28,3
        db 16,28,3,17,28,3,18,28,3,19,28,3,20,28,3,21,28,148,22,28,148,23,28,148,24
        db 28,148,25,28,3,26,28,3,27,28,3,28,28,3,29,28,3,12,29,78,13,29,79,14,29,3,15
        db 29,3,16,29,3,17,29,3,18,29,3,19,29,25,20,29,25,21,29,3,22,29,3,23,29,3,24,29,3,25,29,3,26,29,3,27,29,7
        db 12,30,15,13,30,28,14,30,7,15,30,27,16,30,78,17,30,79,18,30,79,19,30,28,20
        db 30,86,21,30,78,22,30,79,23,30,79,24,30,7,25,30,7,26,30,27,27,30,29,12,31,15
        db 13,31,15,14,31,28,15,31,86,16,31,86,17,31,29,18,31,29,19,31,30,20,31,29,21,31,30,22,31,29
        db 23,31,29,24,31,86,25,31,28
        db 26,31,27,27,31,28,13,32,30,14,32,29,15,32,28,16,32,28,17,32,29,18,32,29
        db 19,32,29,20,32,29,21,32,29,22,32,29,23,32,29,24,32,28,25,32,27,26,32,27,27
        db 32,28,13,33,29,14,33,27,15,33,7,16,33,27,17,33,81,18,33,28,19,33,28,20,33
        db 29,21,33,28,22,33,28,23,33,80,24,33,7,25,33,7
        db 26,33,27,14,34,27,15,34,42,16,34,140,17,34,7,18,34,81,19,34,28,20,34,27
        db 21,34,81,22,34,81,23,34,12,24,34,6,25,34,23,10,35,42,11,35,43,14,35,43,15
        db 35,42,16,35,41,17,35,140,22,35,65,23,35,42,24,35,6,25,35,6,28,35,43,29,35
        db 42,10,36,42,11,36,42,12,36,6,13,36,42,14,36,42
        db 15,36,6,16,36,6,17,36,42,23,36,42,24,36,42,25,36,42,26,36,42,27,36,43
        db 28,36,42,29,36,42,30,36,6,9,37,6,10,37,42,11,37,42,12,37,42,13,37,6,14
        db 37,42,15,37,42,16,37,6,17,37,42,23,37,42,24,37,42,25,37,42,26,37,42,27
        db 37,42,28,37,41,29,37,42,30,37,6,9,38,42,10,38,42
        db 11,38,42,12,38,42,13,38,6,14,38,6,15,38,42,16,38,42,17,38,42,22,38
        db 38,6,11,39,42,12,39,6,13,39,42,14,39,42,15,39,42,16,39,42,17,39,42,22
        db 39,42,23,39,42,24,39,42,25,39,42,26,39,42,27,39,42,28,39,42
        db 29,39,42
        Chicken1Size dw 40 
        Chicken_X dw 10
        Chicken_Y dw 10 
        insideChick1 db '1'
        insideChick2 db '2'
        insideChick3 db '3'
        CHICK1orCHICK2 db 0
        CHICK1_COUNTER db 0
        CHICK2_COUNTER db 0
        CHICK1_LorR db 0
        CHICK2_LorR db 0
        GAMECOUNTER DB 0
        temp_var db ?
        
    .code
        include macros.inc
        include gui_proc.inc 
        include PROCs.inc 
        include Chat.inc

        MAIN PROC FAR
            MOV AX,@DATA
            MOV DS,AX
            mov Es,ax
            
            call intialize
        ;bbbb:
            mov al, 03
            mov ah, 0
            int 10h
            ClearScreen 0,0,79,24
            call player1Screen

            ClearScreen 0,0,79,24

            call check_R_Buffer
            cmp check_buffer_status , 1
            jz receive_then_send
            call send_name_player2
            call read_name_player2
            ;call send_name_player2
            jmp bbbb
            receive_then_send:
            mov V_S_R,3dh
            call send_name_points
            call read_name_player2
            call send_name_player2
            ;call read_name_player2

            ;jmp bbbb
            ;cmp not_r,1
            ;jz send_again
            ;jmp bbbb
            ;send_again:
            call send_name_player2
            ;call read_name_player2
            ;call send_receive_name
            
        bbbb:
        ;Print_Msg player1_mess
        ;call send_name_player2
        ;call read_name_player2
        setTextCursor 35, 6
        Print_Msg player2_name[2]
        ;DisplayChar  0,0 ,player2_name[2]
        ;DisplayChar  1,0 ,player2_name[3]
        ;DisplayChar  2,0 ,player2_name[4]
        ;DisplayChar  3,0 ,player2_name[5]

        
        ;call beginGame

        ;jmp bbbb

        call check_R_Buffer
        cmp check_buffer_status , 1
        jnz Empty_buffer_here
        jmp noEmpty_buffer_here
        Empty_buffer_here:
        call receive_name_points
        noEmpty_buffer_here:
        
        mov V_S_R,0
    ;-------------------------------------------  call main screen ---------------------------------------------------
        
        return_after_finish:

        mov p1_button_F1_F2_ESC,9
        mov p2_button_F1_F2_ESC,8
        ClearScreen 0,0,79,24
        call main_choose


        ;---------------------------------------------------------chat assad code 
        chat_logic:
            call MainChatting
            jmp return_after_finish
        jmp chat_logic
        
        game_logic:
            ClearScreen 0,0,79,24
            ;Print_Msg player2_name[2]

            ; if 1 -> my turn 0 -> other player
            cmp player_turn,1
            jz i_start
            jmp he_start
            i_start:
            call player1_forbidden_screen
            mov al, forbidden_char2
            mov V_S_R,al 
            call send_name_points
            mov al, selected_level
            mov V_S_R,al 
            call send_name_points
            call receive_name_points
            mov al,V_S_R
            mov Forbidden_char1,al
            jmp to_begin_game
            jmp game_logic
            he_start:   
            call receive_name_points
            mov al,V_S_R
            mov Forbidden_char1,al
            call receive_name_points
            mov al,V_S_R
            mov selected_level,al
            call  player2_forbidden_screen
            mov al,forbidden_char2
            mov V_S_R,al
            call send_name_points
        jmp to_begin_game
    ;    jmp game_logic

    to_begin_game:
            ClearScreen 0,0,79,24

    ;jmp to_begin_game

    ;----------------------------------------- setforbiddn for2 players and intial_points

    call set_forbidden_player1
    call set_forbidden_player2

    mov al,intial_points_player2
    cmp intial_points_player1,al
    jA p1_greater
    jmp p2_greater

    p1_greater:
    mov al,intial_points_player2
    mov intial_points_player1,al
    jmp begin

    p2_greater:
    mov al,intial_points_player1
    mov intial_points_player2,al

    ;------------------------------------------------------
            level1Player2SC:
            ;call beginGame

            begin:


            mov al, 12h ; Video mode number
            mov ah, 0h
            int 10h
        MAINLOOP:

                                                    ;     MOV AH,1
                                                    ;     INT 16h
                                                    ;     JZ CHECKOUTGAME
                                                    ;     MOV AH,0
                                                    ;     INT 16h
                                                    ;     cmp ah,1
                                                    ;     jnz CHECKOUTGAME 
                                                    ;     JMP FAR PTR bbbb
                                                    ; CHECKOUTGAME:
                                                    ;     CMP GAMECOUNTER,7
                                                    ;     JNZ CONT109
                                                    ;     CALL  GAMEPROCCALL
                                                    ;     mov al, 12h ; Video mode number
                                                    ;     mov ah, 0h
                                                    ;     int 10h
                                                    ;     CONT109:
                                                    ;     INC GAMECOUNTER

                                                ;------------------------------------------------- now game begin with player_turn 1-> player1 start ---------------

                                                ; --------------------------------
                                                ;   compare PLAYERTURN with 1 so that determine which player will start 
                                                ;   if 1 -> start with first procedure else receive
                                                ;   sent_instruct_type 
                                                ;   p1_turn 
                                                ;
                                                ;receive 0->instruction ; byte -> 0 mov 1 add 2 sub 
                                                ;        1 ->  power1
                                                ;        3 -> power3 -> forbidden 

                                                ;----------------------------------------
            
            cmp player_turn ,1 
            jz my_turn_p1
            jmp far ptr not_my_turn_p1
            my_turn_p1:
            ; call bolbol procedure
                mov player_turn,0
                mov address_mode2,0
                mov address_mode,0
                CALL TURN 
                
                            call Reach_target_player2
                            cmp win_player1,1 
                            jz setendgame
                            call zero_points_player2
                            cmp win_player1,1 
                            jz setendgame
                            jmp sent_first_p2
                            setendgame:
                            mov sent_instruct_type,8
                            mov V_S_R,8
                            call send_name_points
                            ;call send_instruction_p2
                            jmp far ptr endgame

        sent_first_p2:
            
                call send_instruction_p2
                
        not_my_turn_p1:
        
            call CLR
            cmp selected_level,'1'
            jnz lotfy_label
            call Fixed
            jmp bolbol
            lotfy_label:
            call FIXED_LEVEL_TWO
            bolbol:
            call receive_instruction_p2

    ;---------------------------------------- call bolbolcode 
            call instOrPowUpofT2
            call CLR
            mov player_turn,1

        JMP MAINLOOP

        endgame:

        CALL winnerscreen
        
        jmp far ptr return_after_finish 
            ; hlt


        end_game_finihsed:
            ClearScreen 0,0,79,24
            ;print end_mes
        jmp end_game_finihsed
        
        MAIN endp
            finish:
        endoffile:





        main_choose proc near
    ;------------ draw first ---------------------
            ;call CLR
            ClearScreen 0,0,79,24
            movCursor 25,7
            print message1 
            movCursor 25,12
            print message2
            movCursor 25,17
            print message3

    ;---------- take button click and send it 

    start_m_Chat_game:
            mov ah,1
            int 16h 
            jz to_receive_pressed_button
            jmp to_not_receive_pressed_button
            to_receive_pressed_button:
            jmp far ptr receive_pressed_button
            to_not_receive_pressed_button:
            mov ah,0
            int 16H
            
            mov V_S_R,ah
            ;call send_name_points
            
            call send_without_wait
            mov p1_button_F1_F2_ESC,ah
            cmp ah,1
            jne not_ESC
            ;DisplayChar 3,3,'E'
            jmp far ptr Send_end_game
            not_ESC:
            cmp ah,59
            jne notf11
            ;DisplayChar 3,3,'G'
            jmp far ptr game_clicked
            notf11:
            cmp ah,60
            jne  start_m_Chat_game ; or receive ?!
            ;DisplayChar 3,3,'C'
            jmp chat_clicked
            ;jmp far ptr loo

    chat_clicked:

    movCursor 0,22
    print chat_invitation
    print player2_name[2] 
    mov al,p2_button_F1_F2_ESC
    cmp p1_button_F1_F2_ESC,al
    jz now2_chat_begin
    jmp receive_pressed_button
    now2_chat_begin:
        ClearScreen 0,0,79,24
    jmp far ptr chat_logic

    game_clicked:
    movCursor 0,22
    print game_invitation 
    print player2_name[2] 

    mov al,p2_button_F1_F2_ESC
    cmp p1_button_F1_F2_ESC,al

    jz now2_game_begin
    jmp receive_pressed_button
    now2_game_begin:
        ClearScreen 0,0,79,24
        mov player_turn ,0
    jmp far ptr game_logic



    ; receive_without_wait-------------------------------------------------------------------------------------

    receive_pressed_button:

            call receive_without_wait
            mov al, V_S_R
            mov p2_button_F1_F2_ESC,al
            ;DisplayChar 30,0,ah

    ; check if esc so that end
            cmp p2_button_F1_F2_ESC ,1
            jz yes_esc
            jmp not_Send_end_game
            ;jz Send_end_game
            yes_esc:
            jmp far ptr end_game_finihsed
            not_Send_end_game:

    ; check game or not 
            cmp p2_button_F1_F2_ESC,59
            jz yes_game_from2
            jmp check_chat_from2
            yes_game_from2:
                    movCursor 0,24
                    print player2_name[2]
                    ;movCursor 16,24
                    print game_invitation2 
                    jmp far ptr check_if_equal



    ; check chat or not 
    check_chat_from2:
            cmp p2_button_F1_F2_ESC,60
            jz yes_chat_from2
            jmp far ptr check_if_equal
            yes_chat_from2:
                    movCursor 0,24
                    print player2_name[2]
                    ;movCursor 16,24
                    print chat_invitation2 


    ; check if equal ----------------------------------------------------
    check_if_equal:
            mov al, p1_button_F1_F2_ESC
            cmp p2_button_F1_F2_ESC,al

            jz chat_or_game_or_esc
            jmp far ptr start_m_Chat_game
            chat_or_game_or_esc:

            cmp p2_button_F1_F2_ESC ,59
            jz now_game_begin 
            jmp far ptr start_m_Chat_game
            now_game_begin:
                ClearScreen 0,0,79,24
                mov player_turn ,1
            jmp far ptr game_logic

            cmp p2_button_F1_F2_ESC ,60
            jz now_chat_begin 
            jmp far ptr start_m_Chat_game
            now_chat_begin:
                ClearScreen 0,0,79,24
            jmp far ptr chat_logic

    Send_end_game:
    ;-------------------- send here and end
    print end_mes
    jmp far ptr end_game_finihsed

    ret
    main_choose endp






    intialize proc near


    mov dx,3fbh 			
    mov al,10000000b		
    out dx,al				

    mov dx,3f8h			
    mov al,0ch			
    out dx,al

    mov dx,3f9h
    mov al,00h
    out dx,al

    mov dx,3fbh
    mov al,00011011b

    out dx,al


    ret

    intialize ENDp

    send_name_points proc near

            mov dx , 3FDH		
    AGAIN_name_points:  	In al , dx 			
            test al , 00100000b
            JZ AGAIN_name_points    
            ;DisplayChar  1,0 ,'a'                           
            ;jmp AGAIN_name_points
            mov dx , 3F8H		
            mov  al,V_S_R
            out dx , al

    ret
    send_name_points endp


    send_without_wait proc near

            mov dx , 3FDH		
            In al , dx 			
            test al , 00100000b
            JZ AGAIN_without_no   
            jmp AGAIN_without
            AGAIN_without_no:
            jmp far ptr receive_pressed_button 
            AGAIN_without:
            ;DisplayChar  1,0 ,'a'                           
            ;jmp AGAIN_name_points
            mov dx , 3F8H		
            mov  al,V_S_R
            out dx , al

    ret
    send_without_wait endp
    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    ;;;------ check line status
    check_R_Buffer proc near

        mov dx , 3FDH
        in al , dx
        test al , 1
        jz Empty_buffer
        mov check_buffer_status,0
        ;DisplayChar  8,0 ,'0'
        jmp end_check_status
        Empty_buffer:
        mov check_buffer_status,1
        ;DisplayChar  8,0 ,'1'
        
    end_check_status:

    ret
    check_R_Buffer endp
    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    ;;;------------------ receive without wait and jump to start_m_Chat_game
    receive_without_wait proc near

        mov dx , 3FDH
        in al , dx
        test al , 1
        JZ to_send_temp2
        jmp con_rec
        to_send_temp2:
        ;DisplayChar 25,0,'N'
        jmp far ptr start_m_Chat_game
        ; jump to 
    con_rec:
        mov dx , 03F8H
        in al , dx
        mov V_S_R , al
        ;DisplayChar 28,0,'Y'
        ret
        receive_without_wait endp
    ;;;;;;;;;;;;;;;;;;;;;;;;;;; receive_name_points and wait 
    receive_name_points proc near
        
        mov dx , 3FDH
        CHK3: in al , dx
        test al , 1
        jz CHK3
        JZ to_send_temp
        jmp looo
        to_send_temp:
        ;jmp far ptr to_send
    looo:
        mov dx , 03F8H
        in al , dx
        mov V_S_R , al
        mov not_r,1
        ret
        receive_name_points endp



    send_receive_name proc near

            mov cl,player1_name[1]
            mov si ,2
            mov di ,2
        lopon_name_r:


            call receive_name_points
            mov al,V_S_R
            mov player2_name[di],al
            ;DisplayChar  1,0 ,player2_name[di]
            inc di
            cmp di,17
            jz end_S_R_name
            ;jz to_send
        jmp lopon_name_r

    to_send:
            
    ; comment -> send a character 
            
            lopon_name:

            mov al, player1_name[si]
            mov V_S_R,al

            call send_name_points
            ;DisplayChar  2,0 ,V_S_R
            inc si
            cmp si,17
            jz end_S_R_name
            jmp lopon_name


    end_S_R_name:

    ret
    send_receive_name endp

    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    read_name_player2 proc near

        mov si ,2
        loopon_name_r:

        call receive_name_points
            cmp V_S_R,1ch
            jz cont_points
            cmp V_S_R,3dh
            jz loopon_name_r
            mov al,V_S_R
            mov player2_name[si],al
            inc si
        jmp loopon_name_r



        cont_points:
            call receive_name_points
            mov al,V_S_R
            mov intial_points_player2,al

    ret
    read_name_player2 endp

    send_name_player2 proc near


            mov cl,player1_name[1]
            mov si ,2

            loopon_name:
            mov al, player1_name[si]
            mov V_S_R,al

            call send_name_points
            inc si
            dec cx
            jnz loopon_name

            mov V_S_R, 1ch
            call send_name_points

            mov al,intial_points_player1
            mov V_S_R, al
            call send_name_points

    ret
    send_name_player2 endp




    ;-------------------------------------send edits to player2 -----------------------------------------

    ; should i move instial points of player1 ?

    send_inst_sure proc near

        mov V_S_R,0
        call send_name_points
        call sent_general

    ret
    send_inst_sure endp

    send_p1_sure proc near

        mov V_S_R,1
        call send_name_points

        call sent_general

    ret
    send_p1_sure endp

    send_p2_sure proc near

        mov V_S_R,2
        call send_name_points

        call sent_general

    ret
    send_p2_sure endp

    send_p3_sure proc near

        mov V_S_R,3
        call send_name_points

        mov al, forbidden_char2
        mov V_S_R,al
        call send_name_points

    ret
    send_p3_sure endp

    send_p5_sure proc near

        mov V_S_R,5
        call send_name_points

    ret
    send_p5_sure endp

    send_p6_sure proc near

        mov V_S_R,6
        call send_name_points

        mov ax,changed_target
        mov V_S_R,ah
        call send_name_points

        mov ax,changed_target
        mov V_S_R,al
        call send_name_points

    ret
    send_p6_sure endp

    sent_general proc near


        mov al,instucti0n_type
        mov V_S_R,al
        call send_name_points

        mov al,src_index_reg
        mov V_S_R,al
        call send_name_points

        mov al,src_index_val
        mov V_S_R,al
        call send_name_points

        mov al,dest_index_reg
        mov V_S_R,al
        call send_name_points

        mov al,dest_index_val
        mov V_S_R,al
        call send_name_points

        mov al,count_bit_1
        mov V_S_R,al
        call send_name_points

        mov al,count_bit_2
        mov V_S_R,al
        call send_name_points

        mov al,address_mode
        mov V_S_R,al
        call send_name_points

        mov al,address_mode2
        mov V_S_R,al
        call send_name_points

        mov al,Player2_Data_Register[16]
        mov V_S_R,al
        call send_name_points

        mov al,Player2_Data_Register[17]
        mov V_S_R,al
        call send_name_points

        mov al,Player2_Data_Register[18]
        mov V_S_R,al
        call send_name_points

        mov al,Player2_Data_Register[19]
        mov V_S_R,al
        call send_name_points



    ret
    sent_general endp

    send_instruction_p2 proc near 

        cmp sent_instruct_type ,0
        jnz noot_instruct

                ; send instruction to player 2 1) send 0 then 8 bytes 
                
                call send_inst_sure
                
                jmp far ptr end_sent_to_p2

        noot_instruct:

        cmp sent_instruct_type ,1
        jnz noot_po1
                ;
                call send_p1_sure
                jmp far ptr end_sent_to_p2

        noot_po1:

        cmp sent_instruct_type ,2
        jnz noot_po2
                ;
                call send_p2_sure
                jmp far ptr end_sent_to_p2
        noot_po2:

        cmp sent_instruct_type ,3
        jnz noot_po3
                ;
                call send_p3_sure
                jmp far ptr end_sent_to_p2
        noot_po3:

        cmp sent_instruct_type ,5
        jnz noot_po5
                ;
                call send_p5_sure
                jmp far ptr end_sent_to_p2
        noot_po5:

        cmp sent_instruct_type ,6
        
        jnz noot_po6
                ;
                call send_p6_sure
                jmp far ptr end_sent_to_p2
        noot_po6:

    end_sent_to_p2:

    ret
    send_instruction_p2 endp 


    ;-------------------------------------receive edits from player2 -----------------------------------------
    receive_instruction_p2 proc near 

        call receive_name_points
        mov al,V_S_R
        mov sent_instruct_type,al


        ;movCursor 18,10
        ;mov ah,2
        ;mov dl,sent_instruct_type
        ;int 21H
        ;call readonedigitfromkeyboard

        cmp sent_instruct_type,0
        jnz r_noot_instruct
                
                call rec_general
                jmp far ptr end_rec_from_p2

        r_noot_instruct:

        cmp sent_instruct_type ,1
        jnz r_noot_po1
                
                call rec_general
                jmp far ptr end_rec_from_p2
        r_noot_po1:

        cmp sent_instruct_type ,2
        jnz r_noot_po2
                ;
                call rec_general
                jmp far ptr end_rec_from_p2
        r_noot_po2:

        cmp sent_instruct_type ,3
        jnz r_noot_po3
                ;
                call rec_p3_sure
                jmp far ptr end_rec_from_p2
        r_noot_po3:

        cmp sent_instruct_type ,5
        jnz r_noot_po5
                ;
                call rec_p5_sure
                jmp far ptr end_rec_from_p2
        r_noot_po5:

        cmp sent_instruct_type ,6
        jnz r_noot_po6
                ;
                call rec_p6_sure
                jmp far ptr end_rec_from_p2

        r_noot_po6:


    ; chat to be added later 

    cmp sent_instruct_type ,8
        jnz r_noot_win_p2
                
                mov win_player2,1
                jmp far ptr endgame

        r_noot_win_p2:
        

    end_rec_from_p2:
    ret
    receive_instruction_p2 endp 



    rec_p3_sure proc near

    call receive_name_points
    mov al,V_S_R
    mov Forbidden_char1,al

    ret
    rec_p3_sure endp

    rec_p5_sure proc near


    ret
    rec_p5_sure endp

    rec_p6_sure proc near

    call receive_name_points
    mov al,V_S_R
    mov cl,al
    call receive_name_points
    mov al,V_S_R
    mov ah,CL
    mov changed_target,ax


    ret
    rec_p6_sure endp

    rec_general proc near

        call receive_name_points
        mov al,V_S_R
        mov instucti0n_type,al

        call receive_name_points
        mov al,V_S_R
        mov src_index_reg,al

        call receive_name_points
        mov al,V_S_R
        mov src_index_val,al

        call receive_name_points
        mov al,V_S_R
        mov dest_index_reg,al

        call receive_name_points
        mov al,V_S_R
        mov dest_index_val,al


        call receive_name_points
        mov al,V_S_R
        mov count_bit_1,al

        call receive_name_points
        mov al,V_S_R
        mov count_bit_2,al

        call receive_name_points
        mov al,V_S_R
        mov address_mode,al

        call receive_name_points
        mov al,V_S_R
        mov address_mode2,al

        call receive_name_points
        mov al,V_S_R
        mov Player1_Data_Register[16],al

        call receive_name_points
        mov al,V_S_R
        mov Player1_Data_Register[17],al

        call receive_name_points
        mov al,V_S_R
        mov Player1_Data_Register[18],al

        call receive_name_points
        mov al,V_S_R
        mov Player1_Data_Register[19],al

    ret
    rec_general endp



    END MAIN   